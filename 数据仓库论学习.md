# 数据仓库论学习

### 1，两个数据仓库建模理论

##### Kimball模型

度量是由机构的业务过程以及支持它们的源系统来捕捉的，常以数值形式（如订单金额、库存数量等） 出现，维度建模理论称它为事实；事实由大量文本形式的上下文包围着，而且这些上下文常被直观地分割成多个独立的逻辑块，维度建模称之为维，维描述了度量的5 个W (When 、Where 、What 、Who 和Why ）信息，比如什么时间下单、何种方式下单、买的什么、客户是谁等。

![](C:\article\捕获1.PNG)

Kimball 维度建模的星形架构



Kimball 维度建模的主题以星形架构为主，主题和主题之间则用一致性维度
和企业总线体系架构来保证数据仓库的集成和一致，如下图所示：

![](C:\article\捕获2.PNG)

采用Kimball 建模理论的数据仓库体系架构



##### Bill Inmon 模型

数据仓库是“在企业管理和决策中面向主题的、集成的、与时间相关的、不可修改的数据集合”，与其他数据库应用不同的是，数据仓库更像一种过程，对分布在企业内部各处的业务数据的整合、加工和分析的过程，而不是一种可以购买的产品，这就是他所说的“企业信息化工厂” 。

![](C:\article\捕获3.PNG)

Bill Inmon 建模理论的企业级数据仓库体系架构



##### 上述两个模型的对比及应用

从上述对两者数据架构的介绍可以看出， I**nmon 的方法是一种由上而下（ top-down ）的数据仓库构建方法**，其主张首先要对企业数据仓库进行总体规划，并将不同的OLTP 数据集中到面向主题、集成的、不易失的和时间变化的企业数据仓库中。数据集市应该是数据仓库的子集，每个数据集市都是为独立部门专门设计的。**Kimball 方法则相反，其是自下向上的（ down-top ）** 。Kimball 认为数据仓库是一系列数据集市的集合，企业可以通过一致性的维度表和“企业总线架构”来递增式集成各个数据集市， 从而构建整个企业的数据仓库。

Kimball : let people build what they want when they want it, we will integrate them it all when and if we need to.
Inmon: don’t do anything until you have designed everything.
Inmon 的方法部署和开发周期较长，但是容易维护而且高度集成；而且Kimball 的方法可以迅速响应业务需求，快速构建一个数据仓库，但是后期集成和维护较为麻烦。

一般来说，在项目早期和互联网领域， Kimball 的方法更为实用和接地气，因为需求变化快，成效要求快，投资回
报快。因为业务一直在变，系统一直在变，数据一直在变，这种情况下，可以用Kimball 的方法先建立数据集市，而后根据业务的进展再沉淀出企业数据仓库。而对于项目中后期或者其业务基本不变、不需要对短期投资回报率有很高要求的情况下，可以先设计企业数据仓库，而后建立各个业务部门的数据集市，此时Inmon的方法就派上用场了。还会那句话，没有一劳永逸的解决方案，之后合适的方案，后期根据业务需求不断调整技术方案！



### 三层逻辑架构设计

![](C:\article\捕获4.PNG)

数据仓库逻辑分层架构图

##### OODS 层

**数据仓库源头系统的数据表通常会原封不动地存储一份，这称为ODS( Operation Data Store ）层， ODS 层也经常会被称为准备区（ staging area ）**，它们是后续数据仓库层（即基于Kimball 维度建模生成的事实表和维度表层，以及基于这些事实表和明细表加工的汇总层数据）加工数据的来源，同时**ODS 层也存储着历史的增量数量或者全量数据。**

##### DOWD 和DWS 层

数据仓库明细层（ Data Warehouse Detail, D WD ）和数据仓库汇总层（ Data Warehouse Summary, DWS ）是数据平台的主体内容。DWD 和DWS 层的数据是ODS 层数据经过ETL 清洗、转换、加载生成的，而且它们通常都是基于Kimball 的维度建模理论来构建的，并通过一致性维度和数据总线来保证各个子主题
的维度一致性。

##### 应用层（ ADS ）

应用层主要是各个业务方或者部门基于DWD 和DWS 建立的数据集市（ Data Mart ，以下简称DM ），数据集市DM 是相对于DWD 和DWS 的数据仓库（ Data Warehouse ，以下简称DW ）来说的。一般来说，应用层的数据来源于DW层，但原则上不允许直接访问ODS 层的。此外，相比DW 层，应用层只包含部门或者业务方自己关心的明细层和汇总层数据。



**分层优点**：复杂问题简单化、清晰数据结构(方便管理)、增加数据的复用性、隔离原始数据(解耦)

​		ODA     原始数据层  存放原始数据，保持原貌不做处理

​		DWD     明细数据层  对ODS层数据清洗（去除空值，脏数据，超过极限范围的数据）

​		DWS     服务数据层  轻度聚合

​		ADS      应用数据层  具体需求

  **数仓中各层建的表都是外部表**